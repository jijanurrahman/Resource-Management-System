{% extends 'base.html' %}

{% block title %}Resources - Resource Management System{% endblock %}

{% block content %}
<div class="container">
    <div class="search-filter-section">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
            <div>
                <h1 style="font-size: 2rem; font-weight: 700; color: var(--text-primary); margin-bottom: 0.5rem;">
                    <i class="fas fa-box"></i>
                    Resource Management
                </h1>
                <p style="color: var(--text-secondary);">Manage and organize the resources efficiently</p>
            </div>
            
            <button onclick="addResource()" class="btn btn-primary" id="add-resource-btn" style="display: none;">
                <i class="fas fa-plus"></i>
                Add Resource
            </button>
        </div>
        
        <div style="margin-top: 1.5rem;">
            <input type="text" id="search-input" class="search-input" placeholder="Search resources by name or description...">
        </div>
    </div>
    
    <div id="resources-grid" class="resources-grid">
        <!-- Resources will be loaded here -->
    </div>
</div>

<!-- Resource Modal -->
<div id="resource-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-title" class="modal-title">Add Resource</h3>
            <button class="modal-close" onclick="hideModal('resource-modal')">&times;</button>
        </div>
        <div class="modal-body">
            <form id="resource-form">
                <div class="form-group">
                    <label for="resource-name" class="form-label">Resource Name</label>
                    <input type="text" id="resource-name" name="name" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="resource-url" class="form-label">URL</label>
                    <input type="url" id="resource-url" name="url" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="resource-description" class="form-label">Description</label>
                    <textarea id="resource-description" name="description" class="form-input" rows="4" required></textarea>
                </div>
                
                <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 2rem;">
                    <button type="button" class="btn btn-outline" onclick="hideModal('resource-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Save Resource
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', async function() {
    // Wait for main.js to initialize
    await new Promise(resolve => setTimeout(resolve, 100));
    
    // Check authentication
    if (!authToken || !currentUser) {
        showAlert('Please login to access resources.', 'error');
        setTimeout(() => {
            window.location.href = '/login/';
        }, 2000);
        return;
    }
    
    // Show add button if user has permission
    const addBtn = document.getElementById('add-resource-btn');
    if (addBtn && currentUser && (currentUser.role === 'admin' || currentUser.role === 'staff')) {
        addBtn.style.display = 'flex';
    }
    
    // Load resources
    loadResources();
});
</script>
{% endblock %}